{% extends "base.html" %}
{% block content %}
  <h1 class="text-2xl font-semibold mb-2">Dashboard</h1>
  <p class="text-sm text-gray-600 mb-6">Profile: <span id="who">Loadingâ€¦</span></p>

  <div class="bg-white rounded-2xl shadow p-4">
    <h2 class="text-xl font-medium mb-3">ToDo</h2>

    <form class="flex gap-2 mb-4"
          hx-post="/todo"
          hx-target="#todo-list"
          hx-swap="outerHTML">
      <input type="text" name="title" placeholder="New task..." required
             class="flex-1 border rounded-lg px-3 py-2"/>
      <button type="submit" class="px-3 py-2 rounded-lg bg-black text-white">Add</button>
    </form>

    <div id="todo-list"
         hx-get="/todo/partial"
         hx-trigger="load"></div>
  </div>

  <script>
    fetch('/profiles/current').then(r=>r.json()).then(j=>{
      document.getElementById('who').textContent = j.name;
    });
  </script>
{% endblock %}
